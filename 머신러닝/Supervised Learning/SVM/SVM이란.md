### SVM

SVM(Support Vector Machine)은 분류를 위한 기준선을 정의하는 모델이다. 즉, 분류되지 않은 새로운 데이터가 나타나면 결정 경계(기준선)을 기준으로 경계의 어느 쪽에 속하는지 분류하는 모델이다. 서포트 벡터 머신은 커널만 적절히 선택한다면 정확도가 상당히 좋기 때문에 정확도를 요구하는 분류 문제를 다룰 때 사용하면 좋다. 또한, 텍스트를 분류할 때도 많이 사용한다.

결정 경계는 데이터를 분류하기 위한 기준선인데, 다음 그림처럼 빨간색 공과 파란색 공이 있을 때 이 공들을 색상별로 분류하기 위한 기준선이 결정 경계이다.

![svm](https://user-images.githubusercontent.com/79203421/201355229-142930b7-e5f6-4257-b127-e3a4a3e4029e.png)


결정 경계는 데이터가 분류된 클래스에서 최대한 멀리 떨어져 있을 때 성능이 가장 좋다. 여기서 마진(margin)이라는 개념이 사용되는데, 마진은 결정 경계와 서포트 벡터 사이의 거리를 의미한다. 서포트 백터는 결정 경계와 가까이 있는 데이터들을 의미한다. 정리하면, 최적의 결정 경계는 마진을 최대로 해야 한다는 것이다. 위 사진에서 실선과 점선 사이의 공간이 마진이 된다.

서포트 벡터 머신은 데이터들을 올바르게 분리하면서 마진 크기를 최대화해야 하는데, 결국 이상치를 잘 다루는 것이 중요하다. 이때 이상치를 허용하지 않는 것을 하드 마진(hard margin)이라고 하며, 어느 정도의 이상치들이 마진 안에 포함되는 것을 허용한다면 소프트 마진(soft margin)이라고 한다. 

SVM에는 선형 분류와 비선형 분류가 있다.

![svm5](https://user-images.githubusercontent.com/79203421/201355366-300174c3-1987-431b-bd1e-0824f07a064b.png)


비선형 문제를 해결하는 가장 기본적인 방법은 저차원 데이터를 고차원으로 보내는 것인데, 이는 연산량이 매우 높으므로 성능에 문제를 줄 수 있다. 

![svm6](https://user-images.githubusercontent.com/79203421/201355402-7b5b0e52-3a6e-42a3-934c-be4c7a967510.png)


이러한 문제를 해결하고자 도입한 것이 커널 트릭(kernal trick)이다. 선형 모델을 위한 커널에는 선형 커널이 있고, 비선형을 위한 커널에는 가우시안 RBF 커널과 다항식 커널이 있다. 가우시안 RBF 커널과 다항식 커널은 벡터 내적을 계산한 후 고차원으로 보내는 방법으로 연산량을 줄였다.

- 선형 커널(linear kernel): 선형으로 분류 가능한 데이터에 적용하며, 다음의 수식을 사용한다. 기본 커널 트릭으로 커널 트릭을 사용하지 않겠다는 의미와 동일하다.
    - $K(a, b) = a^T\cdot b$   $(a, b: input \ vector)$

- 다항식 커널(polynomial kernel): 실제로는 특성을 추가하지 않지만, 다항식 특성을 많이 추가한 것과 같은 결과를 얻을 수 있는 방법이다. 즉, 엄청난 수의 특성 조합이 생기는 것과 같은 효과를 얻기 때문에 고차원으로 데이터 매핑이 가능하다. 아래 수식에서 감마와 d는 하이퍼파라미터이다.
    - $K(a, b)=(\gamma a^T\cdot b)^d$   $(a, b: input \ vector,\ \gamma: gamma,\ d: demension)$

- 가우시안 RBF 커널(Gaussian RBF kernel): 다항식 커널의 확장 개념이다. 입력 벡터를 차원이 무한한 고차원으로 매핑하는 것으로, 모든 차수의 모든 다항식을 고려한다. 다항식 커널은 차수에 한계가 있는데, 가우시안 RBF는 차수에 제한 없이 무한한 확장이 가능하다. 아래 수식에서 감마는 하이퍼파라미터이다.
    - $K(a, b)=exp(-\gamma||a-b||^2)$

![svm7](https://user-images.githubusercontent.com/79203421/201355409-47f4b0cd-05bf-4178-bfea-bb29d01e1b01.png)
